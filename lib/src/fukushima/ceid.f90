real*8 function ceid(mc)
!
! Double precision minimax rational approximation of D(m):
! the second associate complete elliptic integral of the second kind
!
!     Reference: T. Fukushima, (2015), J. Comp. Appl. Math., 282, 71-76
!
!      "Precise and Fast Computation of General Complete Elliptic
!       Integral of Second Kind"
!
!     Author: T. Fukushima Toshio.Fukushima@nao.ac.jp
!
real*8 mc
real*8 t,t2
if(mc.gt.1.d0) then
    write(*,"(a20,1pe15.7)") "(ceid) negative m: mc=",mc
elseif(mc.gt.0.599909d0) then
    t=2.49943137936119533d0*mc-1.49943137936119533d0
    t2=t*t
    ceid=((1593.39813781813498d0 &
    +t2*(1058.56241259843217d0 &
    +t2*11.7584241242587571d0)) &
    +t*(2233.25576544961714d0 &
    +t2*(195.247394601357872d0 &
    +t2*0.101486443490307517d0)))/ &
    ((1685.47865546030468d0 &
    +t2*(1604.88100543517015d0 &
    +t2*38.6743012128666717d0)) &
    +t*(2756.20968383181114d0 &
    +t2*(397.504162950935944d0 &
    +t2)))
elseif(mc.gt.0.359180d0) then
    t=4.15404874360795750d0*mc-1.49205122772910617d0
    t2=t*t
    ceid=((1967.01442513777287d0 &
    +t2*(1329.30058268219177d0 &
    +t2*15.0447805948342760d0)) &
    +t*(2779.87604145516343d0 &
    +t2*(247.475085945854673d0 &
    +t2*0.130547566005491628d0)))/ &
    ((1749.70634057327467d0 &
    +t2*(1654.40804288486242d0 &
    +t2*39.1895256017535337d0)) &
    +t*(2853.92630369567765d0 &
    +t2*(406.925098588378587d0 &
    +t2)))
elseif(mc.gt.0.214574d0) then
    t=6.91534237860116454d0*mc-1.48385267554596628d0
    t2=t*t
    ceid=((2409.64196912091452d0 &
    +t2*(1659.30176823041376d0 &
    +t2*19.1942111405094383d0)) &
    +t*(3436.40744503228691d0 &
    +t2*(312.186468430688790d0 &
    +t2*0.167847673021897479d0)))/ &
    ((1824.89205701262525d0 &
    +t2*(1715.38574780156913d0 &
    +t2*39.8798253173462218d0)) &
    +t*(2971.02216287936566d0 &
    +t2*(418.929791715319490d0 &
    +t2)))
elseif(mc.gt.0.127875d0) then
    t=11.5341584101316047d0*mc-1.47493050669557896d0
    t2=t*t
    ceid=((2926.81143179637839d0 &
    +t2*(2056.45624281065334d0 &
    +t2*24.3811986813439843d0)) &
    +t*(4214.52119721241319d0 &
    +t2*(391.420514384925370d0 &
    +t2*0.215574280659075512d0)))/ &
    ((1910.33091918583314d0 &
    +t2*(1787.99942542734799d0 &
    +t2*40.7663012893484449d0)) &
    +t*(3107.04531802441481d0 &
    +t2*(433.673494280825971d0 &
    +t2)))
elseif(mc.gt.0.076007d0) then
    t=19.2797100331611013d0*mc-1.46539292049047582d0
    t2=t*t
    ceid=((3520.63614251102960d0 &
    +t2*(2526.67111759550923d0 &
    +t2*30.7739877519417978d0)) &
    +t*(5121.2842239226937d0 &
    +t2*(486.926821696342529d0 &
    +t2*0.276315678908126399d0)))/ &
    ((2003.81997889501324d0 &
    +t2*(1871.05914195570669d0 &
    +t2*41.8489850490387023d0)) &
    +t*(3259.09205279874214d0 &
    +t2*(451.007555352632053d0 &
    +t2)))
elseif(mc.gt.0.045052d0) then
    t=32.3049588111775157d0*mc-1.45540300436116944d0
    t2=t*t
    ceid=((4188.00087087025347d0 &
    +t2*(3072.05695847158556d0 &
    +t2*38.5070211470790031d0)) &
    +t*(6156.0080960857764d0 &
    +t2*(599.76666155374012d0 &
    +t2*0.352955925261363680d0)))/ &
    ((2101.60113938424690d0 &
    +t2*(1961.76794074710108d0 &
    +t2*43.0997999502743622d0)) &
    +t*(3421.55151253792527d0 &
    +t2*(470.407158843118117d0 &
    +t2)))
elseif(mc.gt.0.026626d0) then
    t=54.2711386084880061d0*mc-1.44502333658960165d0
    t2=t*t
    ceid=((4916.74442376570733d0 &
    +t2*(3688.12811638360551d0 &
    +t2*47.6447145147811350d0)) &
    +t*(7304.6632479558695d0 &
    +t2*(729.75841970840314d0 &
    +t2*0.448422756936257635d0)))/ &
    ((2197.49982676612397d0 &
    +t2*(2055.19657857622715d0 &
    +t2*44.4576261146308645d0)) &
    +t*(3584.94502590860852d0 &
    +t2*(490.880160668822953d0 &
    +t2)))
elseif(mc.gt.0.015689d0) then
    t=91.4327512114839536d0*mc-1.43448843375697175d0
    t2=t*t
    ceid=((5688.7542903989517d0 &
    +t2*(4364.21513060078954d0 &
    +t2*58.159468141567195d0)) &
    +t*(8542.6096475195826d0 &
    +t2*(875.35992968472914d0 &
    +t2*0.56528145509695951d0)))/ &
    ((2285.44062680812883d0 &
    +t2*(2145.80779422696555d0 &
    +t2*45.8427480379028781d0)) &
    +t*(3739.30422133833258d0 &
    +t2*(511.23253971875808d0 &
    +t2)))
elseif(mc.gt.0.009216d0) then
    t=154.487872701992894d0*mc-1.42376023482156651d0
    t2=t*t
    ceid=((6475.3392225234969d0 &
    +t2*(5081.2997108708577d0 &
    +t2*69.910123337464043d0)) &
    +t*(9829.1138694605662d0 &
    +t2*(1033.32687775311981d0 &
    +t2*0.70526087421186325d0)))/ &
    ((2357.74885505777295d0 &
    +t2*(2226.89527217032394d0 &
    +t2*47.1609071069631012d0)) &
    +t*(3872.32565152553360d0 &
    +t2*(530.03943432061149d0 &
    +t2)))
elseif(mc.gt.0.d0) then
    t=1.d0-108.506944444444444d0*mc
    ceid=-log(mc*0.0625d0) &
    *(6.2904323649908115d6 &
    +t*(58565.284164780476d0 &
    +t*(131.176674599188545d0 &
    +t*0.0426826410911220304d0)))/ &
    (1.24937550257219890d7 &
    +t*(203580.534005225410d0 &
    +t*(921.17729845011868d0 &
    +t))) &
    -(27356.1090344387530d0 &
    +t*(107.767403612304371d0 &
    -t*0.0827769227048233593d0))/ &
    (27104.0854889805978d0 &
    +t*(358.708172147752755d0 &
    +t))
else
    write(*,"(a20,1pe15.7)") "(ceid) out of range: mc=",mc
endif
!
!write(*,"(1x,a20,0p5f20.15)") "(ceid) mc,D=",mc,ceid
!
return
end
