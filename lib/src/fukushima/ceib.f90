real*8 function ceib(mc)
!
! Double precision minimax rational approximation of B(m):
! the first associate complete elliptic integral of the second kind
!
!     Reference: T. Fukushima, (2015), J. Comp. Appl. Math., 282, 71-76
!
!      "Precise and Fast Computation of General Complete Elliptic
!       Integral of Second Kind"
!
!     Author: T. Fukushima Toshio.Fukushima@nao.ac.jp
!
real*8 mc
real*8 t,t2
if(mc.gt.1.d0) then
    write(*,"(a20,1pe15.7)") "(ceib) negative m: mc=",mc
elseif(mc.gt.0.555073d0) then
    t=2.24755971204264969d0*mc-1.24755971204264969d0
    t2=t*t
    ceib=((2030.25011505956379d0 &
    +t2*(1727.60635612511943d0 &
    +t2*25.0715510300422010d0)) &
    +t*(3223.16236100954529d0 &
    +t2*(361.164121995173076d0 &
    +t2*0.280355207707726826d0)))/ &
    ((2420.64907902774675d0 &
    +t2*(2327.48464880306840d0 &
    +t2*47.9870997057202318d0)) &
    +t*(4034.28168313496638d0 &
    +t2*(549.234220839203960d0 &
    +t2)))
elseif(mc.gt.0.302367d0) then
    t=3.95716761770595079d0*mc-1.19651690106289522d0
    t2=t*t
    ceib=((2209.26925068374373d0 &
    +t2*(1981.37862223307242d0 &
    +t2*29.7612810087709299d0)) &
    +t*(3606.58475322372526d0 &
    +t2*(422.693774742063054d0 &
    +t2*0.334623999861181980d0)))/ &
    ((2499.57898767250755d0 &
    +t2*(2467.63998386656941d0 &
    +t2*50.0198090806651216d0)) &
    +t*(4236.30953048456334d0 &
    +t2*(581.879599221457589d0 &
    +t2)))
elseif(mc.gt.0.161052d0) then
    t=7.07638962601280827d0*mc-1.13966670204861480d0
    t2=t*t
    ceib=((2359.14823394150129d0 &
    +t2*(2254.30785457761760d0 &
    +t2*35.2259786264917876d0)) &
    +t*(3983.28520266051676d0 &
    +t2*(492.601686517364701d0 &
    +t2*0.396605124984359783d0)))/ &
    ((2563.95563932625156d0 &
    +t2*(2633.23323959119935d0 &
    +t2*52.6711647124832948d0)) &
    +t*(4450.19076667898892d0 &
    +t2*(622.983787815718489d0 &
    +t2)))
elseif(mc.gt.0.083522d0) then
    t=12.8982329420869341d0*mc-1.07728621178898491d0
    t2=t*t
    ceib=((2464.65334987833736d0 &
    +t2*(2541.68516994216007d0 &
    +t2*41.5832527504007778d0)) &
    +t*(4333.38639187691528d0 &
    +t2*(571.53606797524881d0 &
    +t2*0.465975784547025267d0)))/ &
    ((2600.66956117247726d0 &
    +t2*(2823.69445052534842d0 &
    +t2*56.136001230010910d0)) &
    +t*(4661.64381841490914d0 &
    +t2*(674.25435972414302d0 &
    +t2)))
elseif(mc.gt.0.041966d0) then
    t=24.0639137549331023d0*mc-1.00986620463952257d0
    t2=t*t
    ceib=((2509.86724450741259d0 &
    +t2*(2835.27071287535469d0 &
    +t2*48.9701196718008345d0)) &
    +t*(4631.12336462339975d0 &
    +t2*(659.86172161727281d0 &
    +t2*0.54158304771955794d0)))/ &
    ((2594.15983397593723d0 &
    +t2*(3034.20118545214106d0 &
    +t2*60.652838995496991d0)) &
    +t*(4848.17491604384532d0 &
    +t2*(737.15143838356850d0 &
    +t2)))
elseif(mc.gt.0.020313d0) then
    t=46.1829769546944996d0*mc-0.938114810880709371d0
    t2=t*t
    ceib=((2480.58307884128017d0 &
    +t2*(3122.00900554841322d0 &
    +t2*57.541132641218839d0)) &
    +t*(4845.57861173250699d0 &
    +t2*(757.31633816400643d0 &
    +t2*0.62119950515996627d0)))/ &
    ((2528.85218300581396d0 &
    +t2*(3253.86151324157460d0 &
    +t2*66.496093157522450d0)) &
    +t*(4979.31783250484768d0 &
    +t2*(812.40556572486862d0 &
    +t2)))
elseif(mc.gt.0.009408d0) then
    t=91.7010545621274645d0*mc-0.862723521320495186d0
    t2=t*t
    ceib=((2365.25385348859592d0 &
    +t2*(3381.09304915246175d0 &
    +t2*67.442026950538221d0)) &
    +t*(4939.53925884558687d0 &
    +t2*(862.16657576129841d0 &
    +t2*0.70143698925710129d0)))/ &
    ((2390.48737882063755d0 &
    +t2*(3462.34808443022907d0 &
    +t2*73.934680452209164d0)) &
    +t*(5015.4675579215077d0 &
    +t2*(898.99542983710459d0 &
    +t2)))
elseif(mc.gt.0.004136d0) then
    t=189.681335356600910d0*mc-0.784522003034901366d0
    t2=t*t
    ceib=((2160.82916040868119d0 &
    +t2*(3584.53058926175721d0 &
    +t2*78.769178005879162d0)) &
    +t*(4877.14832623847052d0 &
    +t2*(970.53716686804832d0 &
    +t2*0.77797110431753920d0)))/ &
    ((2172.70451405048305d0 &
    +t2*(3630.52345460629336d0 &
    +t2*83.173163222639080d0)) &
    +t*(4916.35263668839769d0 &
    +t2*(993.36676027886685d0 &
    +t2)))
elseif(mc.gt.0.d0) then
    t=1.d0-106.292517006802721d0*mc
    ceib=mc*log(mc*0.0625d0) &
    *(6607.46457640413908d0 &
    +t*(19.0287633783211078d0 &
    -t*0.00625368946932704460d0))/ &
    (26150.3443630974309d0 &
    +t*(354.603981274536040d0 &
    +t)) &
    +(26251.5678902584870d0 &
    +t*(168.788023807915689d0 &
    +t*0.352150236262724288d0))/ &
    (26065.7912239203873d0 &
    +t*(353.916840382280456d0 &
    +t))
else
    write(*,"(a20,1pe15.7)") "(ceib) out of range: mc=",mc
endif
!
!write(*,"(1x,a20,0p5f20.15)") "(ceib) mc,B=",mc,ceib
!
return
end
